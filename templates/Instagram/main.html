<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      {% load static %}

    <title>Bootstrap demo</title>
      <style>
        .user-row {
          display: flex;              /* 가로 배치 */
          align-items: center;        /* 세로 가운데 정렬 */
          gap: 10px;                  /* 간격 */
        }

        .box {
          width: 40px; height: 40px;
          border-radius: 50%;
          overflow: hidden;           /* 원 밖으로 넘치는 이미지 가리기 */
          flex: 0 0 auto;             /* 아이콘 크기 고정 */
        }

        .profile {
          width: 100%; height: 100%;
          object-fit: cover;          /* 비율 유지하며 꽉 채우기 */
          display: block;
        }

        .username {
          font-weight: 600;
          white-space: nowrap;        /* 한 줄 유지 (선택) */
          overflow: hidden;           /* 넘치면 … */
          text-overflow: ellipsis;    /* 말줄임표 */
          min-width: 0;               /* flex에서 말줄임표가 먹히도록 */
        }

    .modal_overlay {
        width: 100%;
        height: 100%;
        position: absolute;
        left: 0;
        top: 0;
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(1.5px);
        -webkit-backdrop-filter: blur(1.5px);
    }

    .modal_window {
        background: white;
        backdrop-filter: blur(13.5px);
        -webkit-backdrop-filter: blur(13.5px);
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        width: 800px;
        height: 600px;
        position: relative;
        padding: 10px;
    }

    .image_upload_space{


        width: 780px;
        height: 550px;
    }
      </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

    <!-- google icon -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

<script  src="http://code.jquery.com/jquery-latest.min.js"></script>

  </head>
  <body>
  <!-- 이미지 업로드용 모달 -->
    <div id = "first_modal" class="modal_overlay">
        <div class="modal_window ">
            <div style="display: flex; justify-content: space-between; border-bottom: solid 1px gray" >
                <div>

                </div>
                <div>
                    <p style="text-align: center">새 이미지</p>
                </div>
                <div>
                    <span class="material-symbols-outlined">close</span>
                </div>
            </div>
            <div class="image_upload_space">
            </div>
        </div>
    </div>

  <!-- 글 입력 모달 -->
      <div id = "second_modal" class="modal_overlay">
        <div class="modal_window">
            <div style="display: flex; justify-content: space-between; border-bottom: solid 1px gray" >
                <div>
                </div>
                <div>
                    <p style="text-align: center">새 이미지</p>
                </div>
                <div>
                    <span class="material-symbols-outlined">close</span>
                </div>
            </div>

                <div style="display: flex; justify-content: space-between">
                    <div class="image_upload_space" style="width: 500px"></div>

                    <div style="text-align: center; width: 300px; border-left: solid 1px gray;">
                        <div>
                            <textarea id = "input_feed_content" class="form-control" rows="3"
                                      style="width: 300px; height: 500px; margin-bottom: 10px"></textarea>
                        </div>
                        <button id="feed_create_button" type="button" class="btn btn-primary" style="width: 100%">
                            공유하기
                        </button>
                    </div>

                </div>

        </div>
    </div>

  <nav class="navbar navbar-expand-lg bg-body-tertiary d-flex flex-column vh-100 position-fixed" style="width: 250px;">
  <div class="container-fluid flex-column align-items-start">
    <!-- 로고 -->
    <a class="navbar-brand mb-3" href="#">Instagram</a>

    <!-- 메뉴 버튼 (모바일용) -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- 네비게이션 메뉴 -->
    <div class="collapse navbar-collapse flex-column" id="navbarSupportedContent">
      <ul class="navbar-nav flex-column w-100">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" >🏠 홈</a>
        </li>

        <li class="nav-item">
          <a class="nav-link d-flex align-items-center gap-3 px-2 py-2 rounded-3"
             >
            <!-- search icon -->
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="1.5"/>
              <path d="M20 20l-3.5-3.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>검색</span>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="#">📌 탐색 탭</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">🎞️ 릴스</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
<span class="material-symbols-outlined">home</span>

              메시지</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">❤️ 알림</a>
        </li>
        <li class="nav-item">
          <a id = "nav_bar_add_box" class="nav-link" href="#">➕ 만들기</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">👤 프로필</a>
        </li>

        <!-- 드롭다운 메뉴 -->
        <li class="nav-item dropdown mt-3">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            더보기
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">설정</a></li>
            <li><a class="dropdown-item" href="#">저장됨</a></li>
            <li><a class="dropdown-item" href="#">모드 전환</a></li>
            <li><a class="dropdown-item" href="#">문제 신고</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#">기타 옵션</a></li>
          </ul>

        </li>
      </ul>

      <!-- 검색창 -->
      <form class="d-flex mt-4 w-100" role="search">
        <input class="form-control me-2" type="search" placeholder="검색" aria-label="Search">
        <button class="btn btn-outline-primary" type="submit">검색</button>
      </form>
    </div>
  </div>
</nav>

<!-- 메인 콘텐츠 -->
<div style="margin-left: 250px; display: flex; justify-content: space-between; flex-direction: row;  padding: 20px; background:#FAFAFA"  >
    <div style= "background: antiquewhite; width:600px; height:1000px;" >
        <!-- 피드  -->
        {% for feed in feeds %}
        <div style="border:solid 1px black; background: white;">
            <div class="user-row" style="margin: 0 20px">
                <div class="box">
                    <img class = "profile" src = {{ feed.profile_image }} >

                    사용자 정보
                </div>
                <div> {{ feed.user_id }}</div>
            </div>
            <div style="margin-inside: 20px">
            <img style="width:100%; height:auto" src={% get_media_prefix %}{{ feed.image }}>
            </div>

            <div style="display:flex; flex-direction: row; justify-content: space-between">

                
  <!-- 왼쪽 아이콘 그룹 -->
  <div class="d-flex align-items-center gap-3">
    <span class="material-symbols-outlined"> favorite </span>


      <span class="material-symbols-outlined">mode_comment</span>


      <span class="material-symbols-outlined">send</span>

  </div>

  <!-- 오른쪽 아이콘 (저장/북마크) -->

    <span class="material-symbols-outlined">bookmark</span>

</div>
            <div style="text-align: left; font-size:14px; margin: 0 20px"> 춘식이 외 <b>{{ feed.like_count }}</b>이 좋아합니다.</div>
            <!-- 컨텐츠내용 -->
            <div style="text-align: left; font-size:16px; margin: 0 20px"> <b>{{ feed.user_id }}   </b>{{ feed.content }}</div>
            <!-- comment -->
            <div style="text-align: left; font-size:14px; margin: 0 20px"> <b>푸틴   </b>너무 재밌었습니다</div>
            <div style="text-align: left; font-size:14px; margin: 0 20px"> <b>시진핑   </b>너무 재밌었습니다</div>

            <div class="mb-3">
                <input class="form-control border-0 shadow-none" placeholder="댓글달기">
            </div>

        </div>
        {% endfor %}
        
 
        
    </div>
    <div style= "width:400px; height:1000px;">
        <div class="user-row" style="margin: 0 20px">
            <div class="box" style="width:70px; height: 70px;">
                <img class = "profile" src = "https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg/1200px-Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg" >
            </div>
            <div>
            <div style="font-weight: bold"> 내 아이디</div>
            <div style="color: gray"> 내 이름</div>
            </div>
            </div>
        <div style="display:flex; justify-content: space-between ">
            <div style="font-weight: bold; color: gray">회원님을 위한 추천 </div>
            <div>
                <a href="#" style="font-weight: bold; color:black; text-decoration: none">모두보기</a>
            </div>
        </div>
       <div class="user-row" style="margin: 0 20px">
            <div class="box" style="width:35px; height: 35px;">
                <img class = "profile" src = "https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg/1200px-Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg" >
            </div>
           <div style="display: flex; justify-content: space-between">
            <div>
            <div style="font-weight: bold; font-size: 14px;"> 니 아이디</div>
            <div style="color: gray; font-size: 14px;"> 추천 사유가 여기</div>
            </div>
           </div>
           <div> <a href="#" style="text-decoration: none">팔로우</a></div>
       </div>

       <div class="user-row" style="margin: 0 20px">
            <div class="box" style="width:35px; height: 35px;">
                <img class = "profile" src = "https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg/1200px-Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg" >
            </div>
           <div style="display: flex; justify-content: space-between">
            <div>
            <div style="font-weight: bold; font-size: 14px;"> 니 아이디</div>
            <div style="color: gray; font-size: 14px;"> 추천 사유가 여기</div>
            </div>
           </div>
           <div> <a href="#" style="text-decoration: none">팔로우</a></div>
       </div>

        <div class="user-row" style="margin: 0 20px">
            <div class="box" style="width:35px; height: 35px;">
                <img class = "profile" src = "https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg/1200px-Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg" >
            </div>
           <div style="display: flex; justify-content: space-between">
            <div>
            <div style="font-weight: bold; font-size: 14px;"> 니 아이디</div>
            <div style="color: gray; font-size: 14px;"> 추천 사유가 여기</div>
            </div>
           </div>
           <div> <a href="#" style="text-decoration: none">팔로우</a></div>
       </div>
        <div style="margin-top: 50px; color:gray; font-size: 12px; text-align: left">소개
도움말
홍보 센터
API
채용 정보
            <br>
            
개인정보처리방침
약관
위치
언어
Meta Verified
<br>
            © 2025 Instagram from Meta
        </div>

    </div>

</div>
    


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>


  <script>
      let files;
      
      $('#feed_create_button').click(function() {


          let file = files[0]
          let image = files[0].name;
          let content = $('#input_feed_content').val();
          let user_id = 'ID'
          let profile_image = 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg/1200px-Official_Presidential_Portrait_of_President_Donald_J._Trump_%282025%29.jpg'

          let fd = new FormData();

          fd.append('file', file);
          fd.append('image', image);
          fd.append('content', content);
          fd.append('user_id', user_id);
          fd.append('profile_image',profile_image);
          
          $.ajax({
              url: "/content/upload",
              data: fd,
              method: "POST",
              processData: false,
              contentType: false,

              success: function(data) {
                  console.log('성공');
              },

              error: function(request, status, error) {
                  console.log('에러');
              },

              complete: function() {
                  console.log("완료");
                  location.replace("/main")
              }
          })
      })

      $('#nav_bar_add_box').click(function() {
          $('#first_modal').css({
              display:'flex'
          });

          $(document.body).css({
              overflow: 'hidden'
          });
      })
      $('.material-symbols-outlined').click(function (){
          $('.modal_overlay').css({
              display:"none"
          })
          alert('style눌림')

      })

      $('.image_upload_space')
          .on("dragover", dragOver)
          .on("dragleave", dragOver)
          .on("drop", uploadFiles);

      function dragOver(e){
          e.stopPropagation();
          e.preventDefault();
          if (e.type == "dragover") {
              $(e.target).css({
                  "background-color":"black",
                  "outline-offset":"-20px"
              });
          }
          else {
              $(e.target).css({
                  "background-color":"gray",
                  "outline-offset":"-10px"
              })
          }
      }


      function uploadFiles(e){
          e.stopPropagation();
          e.preventDefault();
          console.log(e);
          e.dataTransfer = e.originalEvent.dataTransfer; //2
          files = e.target.files || e.dataTransfer.files;
          console.log(files);
          if (files.length > 1) {
              alert('하나만 올려라.');
              return;
          }


          if (files[0].type.match(/image.*/)) {
              $('#first_modal').css({
                  display:'none'
             });
              $('#second_modal').css({
                  display:'flex'
                  })
              $('.image_upload_space').css({
                  "background-image": "url(" + window.URL.createObjectURL(files[0]) + ")",
                  "outline": "none",
                  "background-size": "100%",
                  "background-position": "center",
                  "background-repeat":"no-repeat"
              })


}else{
  alert('이미지가 아닙니다.');
  return;
}

      }
      


  </script>
  </body>
</html>